<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Dashmin Form Builder Prototype</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        #builder {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 1rem;
        }

        #toolbox,
        #form-fields {
            min-height: 200px;
            padding: 1rem;
            border: 2px dashed var(--muted-color);
            border-radius: 0.5rem;
        }

        #toolbox .field,
        #form-fields .field {
            padding: 0.5rem;
            margin: 0.25rem 0;
            border: 1px solid var(--muted-border-color);
            border-radius: 0.25rem;
            background: var(--card-background-color);
            cursor: grab;
        }

        .sortable-ghost {
            opacity: 0.4;
        }
    </style>
</head>

<body>
    <main class="container">
        <h1>Dashmin Form Builder</h1>
        <div id="builder">
            <section id="toolbox">
                <h3>Toolbox</h3>
                <div class="field" data-type="input">
                    <label>Input</label>
                    <input type="text" placeholder="Generic input">
                </div>
                <div class="field" data-type="textarea">
                    <label>Textarea</label>
                    <textarea placeholder="Multiline text"></textarea>
                </div>
                <div class="field" data-type="select">
                    <label>Select</label>
                    <select>
                        <option>Option 1</option>
                        <option>Option 2</option>
                    </select>
                </div>
                <div class="field" data-type="file">
                    <label>File upload</label>
                    <input type="file">
                </div>
            </section>
            <section id="form-fields">
                <h3>Form</h3>
                <p class="muted" id="empty-hint">Drag fields here to build your form</p>
            </section>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.3/Sortable.min.js"></script>
    <script>
        let fieldCounter = 0;

        // Toolbox = source list (clone mode)
        new Sortable(document.getElementById('toolbox'), {
            group: {
                name: 'fields',
                pull: 'clone',   // clone on drag
                put: false       // prevent reordering toolbox
            },
            sort: false,        // keep toolbox static
            animation: 150
        });

        // Form = target list (sortable + accepts clones)
        new Sortable(document.getElementById('form-fields'), {
            group: {
                name: 'fields',
                pull: false,
                put: true
            },
            animation: 150,
            ghostClass: 'sortable-ghost',
            onAdd: function (evt) {
                fieldCounter++;
                const id = `f${fieldCounter}`;
                const name = `field_${fieldCounter}`;

                const field = evt.item;
                const input = field.querySelector('input, textarea, select');
                const label = field.querySelector('label');

                // assign unique attributes
                if (input) {
                    input.id = id;
                    input.name = name;
                }
                if (label && input) {
                    label.setAttribute('for', id);
                }

                // remove hint once first field is added
                document.getElementById('empty-hint').style.display = 'none';
            }
        });
    </script>
</body>

</html>